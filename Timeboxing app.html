
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Timeboxing App - Time Management Tool | Timer Machine</title>
    <meta name="description" content="Free online timeboxing app and timer machine. Manage tasks efficiently with our productivity tool. Import JSON, bulk tasks, and smart timer controls.">
    <meta name="keywords" content="timeboxing app, free timeboxing, time management, productivity timer, task manager, timer machine, pomodoro alternative, time blocking">
    <meta name="author" content="Ashish Puri">
    <meta property="og:title" content="Free Timeboxing App - Time Management Tool">
    <meta property="og:description" content="Boost productivity with our free timeboxing app. Smart timer, task management, and flexible controls.">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Timeboxing App - Timer Machine">
    <meta name="twitter:description" content="Free online timeboxing tool for better time management and productivity.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-weight: 600;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .input-section {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 10px;
            margin-bottom: 15px;
            align-items: end;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 500;
            margin-bottom: 5px;
            color: #555;
        }
        
        input, textarea, select {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 5px;
        }
        
        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .tab.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-weight: 500;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .task-list {
            margin-top: 20px;
        }
        
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.7);
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .task-item.active {
            background: rgba(102, 126, 234, 0.2);
            border-left-color: #4CAF50;
            border: 2px solid #4CAF50;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }
        
        .task-item.paused {
            background: rgba(243, 156, 18, 0.2);
            border: 2px solid #f39c12;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
        }
        
        .task-info {
            flex: 1;
        }
        
        .task-name {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .task-time {
            color: #666;
            font-size: 14px;
        }
        
        .timer-display {
            font-size: 24px;
            font-weight: 600;
            color: #667eea;
            margin-right: 15px;
        }
        
        .task-controls {
            display: flex;
            gap: 5px;
            align-items: center;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 5px;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-success {
            background: #4CAF50;
        }
        
        .btn-warning {
            background: #f39c12;
        }
        
        .btn-info {
            background: #3498db;
        }
        
        .move-controls {
            display: flex;
            flex-direction: column;
            gap: 2px;
            margin-right: 10px;
        }
        
        .move-btn {
            padding: 2px 6px;
            font-size: 10px;
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .move-btn:hover {
            background: #7f8c8d;
        }
        
        .warning-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(231, 76, 60, 0.95);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(10px);
        }
        
        .warning-popup h3 {
            margin-bottom: 15px;
            color: white;
        }
        
        .warning-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .warning-controls button {
            padding: 8px 15px;
            font-size: 12px;
        }
        
        .time-input {
            width: 60px;
            padding: 5px;
            margin: 0 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }
        
        .footer-section {
            margin-top: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            color: white;
        }
        
        .timeboxing-info {
            margin-bottom: 30px;
        }
        
        .timeboxing-info h3 {
            color: white;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .timeboxing-info p {
            line-height: 1.6;
            margin-bottom: 10px;
            text-align: justify;
        }
        
        .social-links {
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 20px;
        }
        
        .social-links h4 {
            color: white;
            margin-bottom: 15px;
        }
        
        .social-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            margin: 0 15px;
            font-size: 14px;
            transition: color 0.3s;
        }
        
        .social-links a:hover {
            color: white;
        }
        
        .donate-link {
            display: inline-block;
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white !important;
            padding: 8px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-weight: 500;
        }
        
        .bulk-input {
            width: 100%;
            min-height: 150px;
            margin-bottom: 10px;
            font-family: monospace;
            font-size: 13px;
        }
        
        .example {
            background: rgba(102, 126, 234, 0.1);
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .timer-controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .timer-controls button {
            margin: 0 5px;
            font-size: 16px;
            padding: 15px 25px;
        }
        
        .time-adjustments {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
        }
        
        .time-adjustments button {
            padding: 10px 15px !important;
            font-size: 14px !important;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .floating-credit {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 8px 15px;
            border-radius: 25px;
            font-size: 12px;
            color: #667eea;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            z-index: 1000;
        }
        
        .hint {
            font-size: 11px;
            color: #888;
            margin-bottom: 8px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>⏰ Timeboxing App</h1>
        
        <div class="card">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('manual')">Add Task</div>
                <div class="tab" onclick="switchTab('bulk')">Paste List</div>
            </div>
            
            <!-- Manual Entry Tab -->
            <div id="manual" class="tab-content active">
                <div class="input-section">
                    <div class="input-group">
                        <label for="taskName">Task Name:</label>
                        <input type="text" id="taskName" placeholder="Enter task name...">
                    </div>
                </div>
                <div class="input-section">
                    <div class="input-group">
                        <label for="taskTime">Duration (minutes):</label>
                        <input type="number" id="taskTime" min="1" placeholder="Enter duration...">
                    </div>
                    <button onclick="addTask()">Add Task</button>
                </div>
            </div>
            
            <!-- Bulk Paste Tab -->
            <div id="bulk" class="tab-content">
                <label for="bulkInput">Paste your task list:</label>
                <div class="example">
                    Email review - 15<br>
                    Project meeting - 30<br>
                    Code review - 45
                </div>
                <textarea id="bulkInput" class="bulk-input" placeholder="Email review - 15&#10;Project meeting - 30&#10;Code review - 45"></textarea>
                <button onclick="parseBulkTasks()">Add Tasks</button>
            </div>
            

        </div>
        
        <!-- Separate JSON Import Section -->
        <div class="card">
            <h3>📄 JSON Import</h3>
            <div class="hint">💡 Use any AI system to make the JSON file</div>
            
            <div class="example">
                <strong>Copy this example to any AI:</strong><br><br>
                "Convert my tasks to JSON format. Time is in minutes. Only return the JSON, no explanations:<br><br>
                - Email review: 15 minutes<br>
                - Project meeting: 30 minutes<br>
                - Code review: 45 minutes"<br><br>
                <strong>Expected output:</strong><br>
                [{"name": "Email review", "duration": 15}, {"name": "Project meeting", "duration": 30}, {"name": "Code review", "duration": 45}]
            </div>
            
            <label for="jsonInput">Paste JSON file of all tasks to do:</label>
            <textarea id="jsonInput" class="bulk-input" placeholder='[{"name": "Email review", "duration": 15}, {"name": "Project meeting", "duration": 30}]'></textarea>
            <button onclick="parseJsonTasks()">Add Tasks</button>
        </div>
        
        <!-- Timer Controls -->
        <div class="card timer-controls">
            <button onclick="startTimer()" id="startBtn">▶️ Start</button>
            <button onclick="pauseTimer()" id="pauseBtn">⏸️ Pause</button>
            <button onclick="stopTimer()" id="stopBtn">⏹️ Stop</button>
            <button onclick="skipTask()" id="skipBtn">⏭️ Next Task</button>
            <button onclick="previousTask()" id="prevBtn">⏮️ Previous</button>
            <div class="time-adjustments">
                <button onclick="removeOneMinute()" id="removeMinBtn">-1 Min</button>
                <button onclick="addOneMinute()" id="addMinBtn">+1 Min</button>
                <button onclick="removeFiveMinutes()" id="removeFiveMinBtn">-5 Min</button>
                <button onclick="addFiveMinutes()" id="addFiveMinBtn">+5 Min</button>
            </div>
        </div>
        
        <!-- Task List -->
        <div class="card">
            <h3>Task Queue</h3>
            <div class="progress-bar">
                <div class="progress" id="overallProgress" style="width: 0%"></div>
            </div>
            <div id="taskList" class="task-list">
                <p style="text-align: center; color: #666; font-style: italic;">No tasks added yet. Add some tasks above!</p>
            </div>
            <button onclick="clearAllTasks()" style="margin-top: 10px; background: #e74c3c;">Remove All Tasks</button>
        </div>
        
        <!-- Footer Section -->
        <div class="footer-section">
            <div class="timeboxing-info">
                <h3>📦 What is Timeboxing?</h3>
                <p>Timeboxing is a powerful time management technique where you allocate specific time periods (called "timeboxes") to different activities or tasks. Instead of working on tasks until completion, you commit to working on them for a predetermined amount of time.</p>
                <p><strong>Benefits:</strong> Improves focus, prevents perfectionism, creates urgency, helps estimate time better, reduces procrastination, and increases productivity. It's particularly effective for breaking down large projects into manageable chunks.</p>
                <p><strong>How it works:</strong> Set a specific time limit for each task, work intensively during that period, take a break when the time ends, then move to the next task. This method helps maintain momentum and prevents tasks from expanding beyond their allocated time.</p>
            </div>
            
            <div class="social-links">
                <h4>Created by Ashish Puri</h4>
                <a href="https://www.instagram.com/_ashish_puri/" target="_blank">📱 Instagram</a>
                <a href="https://x.com/_ashish_puri" target="_blank">🐦 Twitter/X</a>
                <a href="https://t.me/ashish_puri" target="_blank">💬 Telegram</a>
                <a href="https://github.com/ashcooll" target="_blank">💻 GitHub</a>
                <br>
                <a href="https://coinsend.to/@ashishpuri" target="_blank" class="donate-link">☕ Support My Work</a>
            </div>
        </div>
        
        <!-- Floating Credit -->
        <div class="floating-credit">
            Made by Ashish Puri
        </div>
        
        <!-- Warning Popup -->
        <div id="warningPopup" class="warning-popup">
            <h3>⚠️ Task Almost Done!</h3>
            <p>Only <span id="warningTime">20</span> seconds left</p>
            <div class="warning-controls">
                <button onclick="addOneMinute()" class="btn-success">+1 Min</button>
                <input type="number" id="customTime" class="time-input" placeholder="5" min="1">
                <button onclick="addCustomTime()" class="btn-info">Add Time</button>
                <button onclick="skipTask()" class="btn-warning">Next Task</button>
                <button onclick="dismissWarning()" class="btn-danger">Continue</button>
            </div>
        </div>
    </div>

    <script>
        let tasks = [];
        let currentTaskIndex = 0;
        let timer = null;
        let timeRemaining = 0;
        let isPaused = false;
        let totalTime = 0;
        let elapsedTime = 0;
        let warningShown = false;

        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function addTask() {
            const name = document.getElementById('taskName').value.trim();
            const duration = parseInt(document.getElementById('taskTime').value);
            
            if (!name || !duration || duration <= 0) {
                alert('Please enter a valid task name and duration.');
                return;
            }
            
            tasks.push({
                name: name,
                duration: duration * 60, // Convert to seconds
                completed: false
            });
            
            document.getElementById('taskName').value = '';
            document.getElementById('taskTime').value = '';
            
            updateTaskDisplay();
            calculateTotalTime();
        }

        function parseBulkTasks() {
            const bulkText = document.getElementById('bulkInput').value.trim();
            if (!bulkText) return;
            
            const lines = bulkText.split('\n');
            let addedCount = 0;
            
            lines.forEach(line => {
                line = line.trim();
                if (!line) return;
                
                // Try to parse "Task Name - Duration" format
                const match = line.match(/^(.+?)\s*-\s*(\d+)$/);
                if (match) {
                    const name = match[1].trim();
                    const duration = parseInt(match[2]);
                    
                    if (name && duration > 0) {
                        tasks.push({
                            name: name,
                            duration: duration * 60,
                            completed: false
                        });
                        addedCount++;
                    }
                }
            });
            
            document.getElementById('bulkInput').value = '';
            updateTaskDisplay();
            calculateTotalTime();
            
            if (addedCount > 0) {
                alert(`Successfully added ${addedCount} tasks!`);
            } else {
                alert('No valid tasks found. Please check the format.');
            }
        }

        function parseJsonTasks() {
            const jsonText = document.getElementById('jsonInput').value.trim();
            if (!jsonText) return;
            
            try {
                const jsonTasks = JSON.parse(jsonText);
                let addedCount = 0;
                
                if (Array.isArray(jsonTasks)) {
                    jsonTasks.forEach(task => {
                        if (task.name && task.duration && task.duration > 0) {
                            tasks.push({
                                name: task.name,
                                duration: task.duration * 60,
                                completed: false
                            });
                            addedCount++;
                        }
                    });
                }
                
                document.getElementById('jsonInput').value = '';
                updateTaskDisplay();
                calculateTotalTime();
                
                if (addedCount > 0) {
                    alert(`Successfully imported ${addedCount} tasks!`);
                } else {
                    alert('No valid tasks found in JSON.');
                }
            } catch (e) {
                alert('Invalid JSON format. Please check your input.');
            }
        }

        function calculateTotalTime() {
            totalTime = tasks.reduce((sum, task) => sum + task.duration, 0);
            elapsedTime = 0;
            for (let i = 0; i < currentTaskIndex; i++) {
                if (tasks[i].completed) {
                    elapsedTime += tasks[i].duration;
                }
            }
            updateProgress();
        }

        function updateProgress() {
            const progressPercent = totalTime > 0 ? ((elapsedTime + (tasks[currentTaskIndex]?.duration - timeRemaining || 0)) / totalTime) * 100 : 0;
            document.getElementById('overallProgress').style.width = progressPercent + '%';
        }

        function updateTaskDisplay() {
            const taskList = document.getElementById('taskList');
            
            if (tasks.length === 0) {
                taskList.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">No tasks added yet. Add some tasks above!</p>';
                return;
            }
            
            taskList.innerHTML = tasks.map((task, index) => {
                const isActive = index === currentTaskIndex;
                // Format duration display with hours if needed
                let timeDisplay;
                if (task.duration >= 3600) {
                    const hours = Math.floor(task.duration / 3600);
                    const remainingSeconds = task.duration % 3600;
                    const minutes = Math.floor(remainingSeconds / 60);
                    const seconds = remainingSeconds % 60;
                    timeDisplay = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    const minutes = Math.floor(task.duration / 60);
                    const seconds = task.duration % 60;
                    timeDisplay = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
                
                let timerDisplay = '';
                let taskClass = '';
                
                // Show timer for all tasks but only run for current
                let timerText;
                if (task.duration >= 3600) {
                    const hours = Math.floor(task.duration / 3600);
                    const remainingSeconds = task.duration % 3600;
                    const minutes = Math.floor(remainingSeconds / 60);
                    const seconds = remainingSeconds % 60;
                    timerText = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    const minutes = Math.floor(task.duration / 60);
                    const seconds = task.duration % 60;
                    timerText = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
                let statusIcon = '⏹️';
                
                if (isActive) {
                    if (timer) {
                        taskClass = 'active';
                        statusIcon = '▶️';
                    } else if (isPaused) {
                        taskClass = 'paused';
                        statusIcon = '⏸️';
                    } else {
                        taskClass = 'active';
                    }
                    
                    // Show actual remaining time for current task
                    if (timeRemaining > 0) {
                        let activeTimeText;
                        if (timeRemaining >= 3600) {
                            const hours = Math.floor(timeRemaining / 3600);
                            const remainingSeconds = timeRemaining % 3600;
                            const minutes = Math.floor(remainingSeconds / 60);
                            const seconds = remainingSeconds % 60;
                            activeTimeText = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                        } else {
                            const minutes = Math.floor(timeRemaining / 60);
                            const seconds = timeRemaining % 60;
                            activeTimeText = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                        }
                        timerDisplay = `<div class="timer-display">${statusIcon} ${activeTimeText}</div>`;
                    }
                } else {
                    // Show total duration for other tasks
                    timerDisplay = `<div class="timer-display">${statusIcon} ${remMinutes}:${remSeconds.toString().padStart(2, '0')}</div>`;
                }
                
                if (task.completed) {
                    taskClass += ' completed';
                }
                
                return `
                    <div class="task-item ${taskClass}">
                        <div class="move-controls">
                            <button class="move-btn" onclick="moveTask(${index}, -1)" ${index === 0 ? 'disabled' : ''}>▲</button>
                            <button class="move-btn" onclick="moveTask(${index}, 1)" ${index === tasks.length - 1 ? 'disabled' : ''}>▼</button>
                        </div>
                        <div class="task-info">
                            <div class="task-name">${task.name}</div>
                            <div class="task-time">Duration: ${timeDisplay}</div>
                        </div>
                        ${timerDisplay}
                        <div class="task-controls">
                            <button class="btn-small btn-danger" onclick="removeTask(${index})">Remove</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function removeTask(index) {
            if (index === currentTaskIndex && timer) {
                stopTimer();
            }
            
            tasks.splice(index, 1);
            
            if (currentTaskIndex >= tasks.length) {
                currentTaskIndex = 0;
            }
            
            updateTaskDisplay();
            calculateTotalTime();
        }

        function clearAllTasks() {
            if (tasks.length === 0) {
                alert('No tasks to remove!');
                return;
            }
            
            if (confirm('Are you sure you want to remove all tasks?')) {
                // Stop timer completely
                if (timer) {
                    clearInterval(timer);
                    timer = null;
                }
                
                // Clear everything
                tasks.length = 0;  // Clear array properly
                currentTaskIndex = 0;
                timeRemaining = 0;
                totalTime = 0;
                elapsedTime = 0;
                isPaused = false;
                warningShown = false;
                
                // Dismiss warning
                dismissWarning();
                
                // Force update display
                updateTaskDisplay();
                updateProgress();
            }
        }

        function startTimer() {
            if (tasks.length === 0) {
                alert('Please add some tasks first!');
                return;
            }
            
            // If at end of list, reset to first task
            if (currentTaskIndex >= tasks.length) {
                currentTaskIndex = 0;
                tasks.forEach(task => task.completed = false);
                elapsedTime = 0;
            }
            
            // Set time remaining to current task's duration
            timeRemaining = tasks[currentTaskIndex].duration;
            updateTaskDisplay(); // Update display immediately
            
            // Don't start if already running
            if (timer) {
                return;
            }
            
            isPaused = false;
            warningShown = false;
            
            // Start timer with exactly 1 second intervals
            timer = setInterval(() => {
                if (timeRemaining > 0) {
                    timeRemaining = timeRemaining - 1;  // Subtract exactly 1 second
                    
                    // Show warning at exactly 20 seconds
                    if (timeRemaining === 20 && !warningShown) {
                        showWarning();
                        warningShown = true;
                    }
                    
                    updateTaskDisplay();
                    updateProgress();
                } else {
                    // Task completed - stop timer first
                    clearInterval(timer);
                    timer = null;
                    completeCurrentTask();
                }
            }, 1000);  // Exactly 1000ms = 1 second
            
            updateTaskDisplay();
        }

        function pauseTimer() {
            if (timer) {
                clearInterval(timer);
                timer = null;
                isPaused = true;
                updateTaskDisplay();  // Update to show paused state
            }
        }

        function stopTimer() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            isPaused = false;
            warningShown = false;
            dismissWarning();
            
            // Reset time for current task
            if (currentTaskIndex < tasks.length) {
                timeRemaining = tasks[currentTaskIndex].duration;
            } else {
                timeRemaining = 0;
            }
            
            updateTaskDisplay();
        }

        function skipTask() {
            if (currentTaskIndex >= tasks.length) {
                alert('No more tasks!');
                return;
            }
            
            // Stop current timer
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // Mark current as completed and move to next
            tasks[currentTaskIndex].completed = true;
            elapsedTime += tasks[currentTaskIndex].duration;
            currentTaskIndex++;
            warningShown = false;
            dismissWarning();
            
            if (currentTaskIndex < tasks.length) {
                timeRemaining = tasks[currentTaskIndex].duration;
                // Auto-start the next task
                setTimeout(() => {
                    startTimer();
                }, 500);
            } else {
                timeRemaining = 0;
            }
            
            calculateTotalTime();
            updateTaskDisplay();
        }

        function previousTask() {
            if (currentTaskIndex <= 0) {
                alert('Already at the first task!');
                return;
            }
            
            // Stop current timer
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // Move to previous task
            currentTaskIndex--;
            tasks[currentTaskIndex].completed = false;
            timeRemaining = tasks[currentTaskIndex].duration;
            warningShown = false;
            dismissWarning();
            isPaused = false;
            
            // Auto-start the previous task
            setTimeout(() => {
                startTimer();
            }, 500);
            
            calculateTotalTime();
            updateTaskDisplay();
        }

        function moveTask(index, direction) {
            const newIndex = index + direction;
            
            if (newIndex >= 0 && newIndex < tasks.length) {
                // Swap tasks
                [tasks[index], tasks[newIndex]] = [tasks[newIndex], tasks[index]];
                
                // Update current task index if needed
                if (currentTaskIndex === index) {
                    currentTaskIndex = newIndex;
                } else if (currentTaskIndex === newIndex) {
                    currentTaskIndex = index;
                }
                
                updateTaskDisplay();
            }
        }

        function addOneMinute() {
            if (currentTaskIndex < tasks.length) {
                tasks[currentTaskIndex].duration += 60;
                timeRemaining += 60;
                totalTime += 60;
                warningShown = false;
                dismissWarning();
                updateTaskDisplay();
                updateProgress();
            }
        }

        function removeOneMinute() {
            if (currentTaskIndex < tasks.length && timeRemaining > 60) {
                tasks[currentTaskIndex].duration -= 60;
                timeRemaining -= 60;
                totalTime -= 60;
                warningShown = false;
                dismissWarning();
                updateTaskDisplay();
                updateProgress();
            }
        }

        function addFiveMinutes() {
            if (currentTaskIndex < tasks.length) {
                tasks[currentTaskIndex].duration += 300;
                timeRemaining += 300;
                totalTime += 300;
                warningShown = false;
                dismissWarning();
                updateTaskDisplay();
                updateProgress();
            }
        }

        function removeFiveMinutes() {
            if (currentTaskIndex < tasks.length && timeRemaining > 300) {
                tasks[currentTaskIndex].duration -= 300;
                timeRemaining -= 300;
                totalTime -= 300;
                warningShown = false;
                dismissWarning();
                updateTaskDisplay();
                updateProgress();
            }
        }

        function addCustomTime() {
            const customMinutes = parseInt(document.getElementById('customTime').value);
            if (customMinutes && customMinutes > 0 && currentTaskIndex < tasks.length) {
                const customSeconds = customMinutes * 60;
                tasks[currentTaskIndex].duration += customSeconds;
                timeRemaining += customSeconds;
                totalTime += customSeconds;
                warningShown = false;
                dismissWarning();
                document.getElementById('customTime').value = '';
                updateTaskDisplay();
                updateProgress();
            }
        }

        function showWarning() {
            document.getElementById('warningTime').textContent = timeRemaining;
            document.getElementById('warningPopup').style.display = 'block';
        }

        function dismissWarning() {
            document.getElementById('warningPopup').style.display = 'none';
        }

        // Initialize
        updateTaskDisplay();
    </script>
</body>
</html>